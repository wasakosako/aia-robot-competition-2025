# 要件定義書

## 1. プロジェクト概要

### 1.1 目的
AiA Innovation & Technology Challenge 2025のロボット競技において、勝利を目指すロボットシステムの開発

### 1.2 競技概要
- 自走式ロボットによる２チーム対戦方式の陣取り合戦
- 相手陣地エリア内の全ての標的（計３個）を獲得
- ゴールラインを通過することで勝利
- 制限時間：３分間

## 2. 機能要件

### 2.1 基本機能

#### 2.1.1 自動走行機能
- **要件ID**: RF-001
- **概要**: ロボットが自律的に競技エリア内を移動する
- **詳細**:
  - スタートエリアから自動的にスタート
  - 障害物を回避しながら移動
  - 競技エリアの境界を認識し、場外に出ないよう制御

#### 2.1.2 標的検出・獲得機能
- **要件ID**: RF-002
- **概要**: 相手陣地の標的を検出し、マスから押し出す
- **詳細**:
  - 標的の位置を視覚的に認識
  - 標的に接近し、マスから押し出す動作を実行
  - 獲得優先度：エリア３（4点）→ エリア２（3点）→ エリア１（2点）

#### 2.1.3 ゴール機能
- **要件ID**: RF-003
- **概要**: 標的を全て獲得後、ゴールラインを通過
- **詳細**:
  - 全標的獲得後、最短経路でゴールラインへ向かう
  - 全車輪がゴールラインを通過することで勝利

#### 2.1.4 障壁回避機能
- **要件ID**: RF-004
- **概要**: 自陣・相手陣の障壁を検出し回避
- **詳細**:
  - 障壁の位置を認識
  - 障壁を回避した経路を計画・実行

### 2.2 戦略機能

#### 2.2.1 動的戦略変更機能
- **要件ID**: RF-005
- **概要**: 競技状況に応じて戦略を動的に変更
- **詳細**:
  - 残り時間に応じた優先度変更
  - 相手ロボットの位置・動作を考慮した行動選択

#### 2.2.2 妨害対策機能
- **要件ID**: RF-006
- **概要**: 相手ロボットによる妨害を検出し対処
- **詳細**:
  - 相手ロボットとの接触・衝突を検出
  - 接触時の復帰・再開動作

### 2.3 監視・制御機能

#### 2.3.1 上部カメラ連携機能
- **要件ID**: RF-007
- **概要**: 競技エリア上部のカメラと連携し全体状況を把握
- **詳細**:
  - 上部カメラからの画像データを受信
  - 全体のマップ情報を更新
  - 標的・障壁・相手ロボットの位置情報を取得

#### 2.3.2 リモートPC連携機能
- **要件ID**: RF-008
- **概要**: リモートPCからの指示を受信・実行
- **詳細**:
  - スタート時の初期指示受信
  - リスタート時の指示受信
  - 緊急停止指示への対応

## 3. 非機能要件

### 3.1 性能要件

#### 3.1.1 応答時間
- **要件ID**: NF-001
- **概要**: システムの応答時間要件
- **詳細**:
  - 障害物検出からの回避動作開始：100ms以内
  - 標的検出からの接近動作開始：200ms以内
  - リモートPC指示への応答：50ms以内

#### 3.1.2 精度要件
- **要件ID**: NF-002
- **概要**: 位置・動作の精度要件
- **詳細**:
  - 位置推定精度：±5cm以内
  - 標的への接近精度：±3cm以内
  - ゴールライン通過精度：±2cm以内

### 3.2 信頼性要件

#### 3.2.1 可用性
- **要件ID**: NF-003
- **概要**: システムの可用性要件
- **詳細**:
  - 競技中の動作継続率：99%以上
  - 通信断からの自動復帰：5秒以内
  - 部品落下等からの復帰：リスタート機能で対応

#### 3.2.2 堅牢性
- **要件ID**: NF-004
- **概要**: 物理的な衝撃への耐性
- **詳細**:
  - 相手ロボットとの接触・衝突に耐える設計
  - 障壁への接触に耐える設計
  - 部品の脱落を最小限に抑制

### 3.3 制約条件

#### 3.3.1 ハードウェア制約
- **要件ID**: NF-005
- **概要**: ハードウェア関連の制約
- **詳細**:
  - ベースロボット：ライトローバー（ヴィストン社製）のみ
  - 利用台数：1台のみ
  - 車輪・ボディの変更不可（滑り止め加工は可）
  - 動力源：乾電池または充電池

#### 3.3.2 ソフトウェア制約
- **要件ID**: NF-006
- **概要**: ソフトウェア関連の制約
- **詳細**:
  - リモートPC：1台のみ
  - 操作可能タイミング：スタート時・リスタート時のみ
  - 独自標識の使用不可

#### 3.3.3 競技制約
- **要件ID**: NF-007
- **概要**: 競技ルールによる制約
- **詳細**:
  - 制限時間：3分間
  - 競技エリアサイズ：460cm × 310cm
  - 陣地エリア：60cm × 70cm（9マス）
  - 標的数：3個、障壁数：3個

## 4. システム要件

### 4.1 ハードウェア要件

#### 4.1.1 ロボット本体
- ライトローバー（ヴィストン社製）
- 標準搭載：LiDAR、カメラ（オプション）
- 追加センサー：必要に応じて搭載可能
- 標的押し出し用アタッチメント

#### 4.1.2 リモートPC
- 仕様：1台のみ
- OS：Windows/Linux/macOS
- 通信：WiFi対応
- 処理能力：リアルタイム画像処理可能

#### 4.1.3 ネットワーク機器
- WiFiルーター：チーム準備
- 通信範囲：競技エリア全域をカバー

### 4.2 ソフトウェア要件

#### 4.2.1 ロボット制御ソフトウェア
- 言語：Python推奨
- フレームワーク：ROS（Robot Operating System）
- ライブラリ：OpenCV、NumPy、SciPy

#### 4.2.2 画像処理ソフトウェア
- OpenCV：物体検出・追跡
- 機械学習：TensorFlow/PyTorch（必要に応じて）
- カメラキャリブレーション機能

#### 4.2.3 通信ソフトウェア
- プロトコル：TCP/IP、UDP
- データフォーマット：JSON、MessagePack
- 暗号化：必要に応じて実装

## 5. インターフェース要件

### 5.1 ユーザーインターフェース

#### 5.1.1 リモートPC操作画面
- 競技状況表示（マップ、スコア、残り時間）
- ロボット状態表示（位置、バッテリー、センサー値）
- 緊急停止ボタン
- 戦略選択インターフェース

### 5.2 システムインターフェース

#### 5.2.1 ロボット-リモートPC間通信
- 通信方式：WiFi
- データ形式：JSON
- 通信頻度：10Hz以上
- 通信内容：制御指示、状態情報、画像データ

#### 5.2.2 上部カメラ連携
- 画像取得：リアルタイム
- 画像フォーマット：JPEG/PNG
- 解像度：1920x1080以上推奨

## 6. 品質要件

### 6.1 テスト要件

#### 6.1.1 単体テスト
- 各モジュールの動作確認
- カバレッジ：80%以上
- 自動テスト実行

#### 6.1.2 統合テスト
- システム全体の動作確認
- 競技シナリオに基づくテスト
- 性能要件の検証

#### 6.1.3 実機テスト
- 実際の競技環境でのテスト
- 他チームとの模擬対戦
- 障害回復テスト

### 6.2 保守性要件

#### 6.2.1 コード品質
- コーディング規約の遵守
- ドキュメント整備
- バージョン管理

#### 6.2.2 設定管理
- 設定ファイルの外部化
- 環境別設定の管理
- パラメータ調整の容易性

## 7. リスク要件

### 7.1 技術的リスク

#### 7.1.1 通信不良
- **リスク**: WiFi通信の不安定性
- **対策**: 通信断からの自動復帰機能
- **緊急時対応**: 自律動作モードへの切り替え

#### 7.1.2 センサー故障
- **リスク**: LiDAR、カメラ等の故障
- **対策**: 冗長化、代替センサーの活用
- **緊急時対応**: 縮退運転モード

### 7.2 競技リスク

#### 7.2.1 相手の妨害
- **リスク**: 相手ロボットによる物理的妨害
- **対策**: 堅牢な設計、回避アルゴリズム
- **緊急時対応**: リスタート機能の活用

#### 7.2.2 部品脱落
- **リスク**: 競技中の部品脱落
- **対策**: 確実な固定、衝撃吸収設計
- **緊急時対応**: リスタート宣言

## 8. 成功基準

### 8.1 必須要件
- レギュレーション検査合格
- 競技参加可能
- 基本動作（移動、標的検出、獲得）の実現

### 8.2 推奨要件
- 予選通過
- 上位入賞（3位以内）
- 審査員特別賞受賞

### 8.3 理想要件
- 優勝
- 完全自律動作の実現
- 高度な戦略的判断の実装
